{% extends 'layouts/base.html' %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}{{ view_name }}{% endblock title %}
{% block bodyclass %}hold-transition sidebar-mini layout-fixed{% endblock bodyclass %}

{% block content %}
<div class="content-wrapper">
  <section class="bg-white rounded shadow p-3 mb-1 mt-auto">
    <div class="container-fluid">

      <!-- Optional Cards Section -->
      {% if object %}
      <div class="row mb-3">
        {% for card_template in card_templates %}
          {% include card_template %}
        {% endfor %}
      </div>
      {% endif %}

      <!-- Form Card -->
      <div class="row">
        <div class="col-md-12">
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="card {{ card_class|default:'card-primary' }}">
              <div class="card-header">
                <h3 class="card-title">{{ form_title|default:_("Details") }}</h3>
              </div>
              <div class="card-body">
                {% crispy form %}
                
                {% if extra_fields %}
                  {% for field_html in extra_fields %}
                    {{ field_html|safe }}
                  {% endfor %}
                {% endif %}
              </div>
              {% if not details %}

              {% endif %}
            </div>
          </form>
        </div>
      </div>

      <!-- Optional History Table -->
      {% if history %}
      <div class="row mt-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">{% trans 'History' %}</h3>
            </div>
            <div class="card-body table-responsive">
              <table class="table table-bordered table-hover">
                <thead>
                  <tr>
                    {% for field in history.0.fields %}
                      <th>{{ field }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% for instance in history %}
                  <tr>
                    {% for value in instance.fields.values %}
                      <td>{{ value }}</td>
                    {% endfor %}
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      {% endif %}

    </div>
  </section>
</div>
{% endblock content %}

{% block extra_scripts %}
<script src="{% static 'js/spinner_submit.js' %}"></script>
{% if datatables %}
<!-- DataTables JS -->
<script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap5.min.js' %}"></script>
<script src="{% static 'plugins/datatables-responsive/js/dataTables.responsive.min.js' %}"></script>
<script src="{% static 'plugins/datatables-responsive/js/responsive.bootstrap5.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.bootstrap5.min.js' %}"></script>
<script src="{% static 'plugins/jszip/jszip.min.js' %}"></script>
<script src="{% static 'plugins/pdfmake/pdfmake.min.js' %}"></script>
<script src="{% static 'plugins/pdfmake/vfs_fonts.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.print.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.colVis.min.js' %}"></script>
{% endif %}
{% endblock extra_scripts %}
