{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
<div class="container py-5">
  <div class="row g-4 justify-content-center">

    <!-- Total Users -->
    <div class="col-12 col-md-4">
      <div class="card border-0 shadow-lg h-100 card-hover text-center position-relative overflow-hidden">
        <div class="card-body d-flex flex-column justify-content-center align-items-center py-5">
          <div class="bg-primary bg-gradient rounded-circle d-flex justify-content-center align-items-center shadow-lg circle-icon">
            <i class="fas fa-users text-white fs-2"></i>
          </div>
          <h6 class="text-uppercase text-muted fw-semibold mt-4 mb-2">Total Users</h6>
          <h2 class="fw-bold text-dark mb-0">{{ total_users }}</h2>

          <button class="btn btn-sm btn-outline-primary mt-3"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#totalUsersCollapse"
                  aria-expanded="false"
                  aria-controls="totalUsersCollapse"
                  {% if all_users|length == 0 %}disabled{% endif %}>
              Show Users
          </button>

          <div class="collapse mt-3 w-100" id="totalUsersCollapse">
            <ul class="list-group list-group-flush text-start shadow-sm rounded">
              {% for user in all_users %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                {{ user.username }}
                {% if user.is_active %}
                  <span class="badge bg-success rounded-pill">Online</span>
                {% else %}
                  <span class="badge bg-danger rounded-pill">Offline</span>
                {% endif %}
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Online Users -->
    <div class="col-12 col-md-4">
      <div class="card border-0 shadow-lg h-100 card-hover text-center position-relative overflow-hidden">
        <div class="card-body d-flex flex-column justify-content-center align-items-center py-5">
          <div class="bg-success bg-gradient rounded-circle d-flex justify-content-center align-items-center shadow-lg circle-icon">
            <i class="fas fa-signal text-white fs-2"></i>
          </div>
          <h6 class="text-uppercase text-muted fw-semibold mt-4 mb-2">Online Users</h6>
          <h2 class="fw-bold text-success mb-0">{{ online_users }}</h2>

          <button class="btn btn-sm btn-outline-success mt-3"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#onlineUsersCollapse"
                  aria-expanded="false"
                  aria-controls="onlineUsersCollapse"
                  {% if online_users == 0 %}disabled{% endif %}>
              Show Users
          </button>

          <div class="collapse mt-3 w-100" id="onlineUsersCollapse">
            <ul class="list-group list-group-flush text-start shadow-sm rounded">
              {% for user in all_users %}
                {% if user.is_active %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  {{ user.username }}
                  <span class="badge bg-success rounded-pill">Online</span>
                </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Offline Users -->
    <div class="col-12 col-md-4">
      <div class="card border-0 shadow-lg h-100 card-hover text-center position-relative overflow-hidden">
        <div class="card-body d-flex flex-column justify-content-center align-items-center py-5">
          <div class="bg-danger bg-gradient rounded-circle d-flex justify-content-center align-items-center shadow-lg circle-icon">
            <i class="fas fa-power-off text-white fs-2"></i>
          </div>
          <h6 class="text-uppercase text-muted fw-semibold mt-4 mb-2">Offline Users</h6>
          <h2 class="fw-bold text-danger mb-0">{{ offline_users }}</h2>

          <button class="btn btn-sm btn-outline-danger mt-3"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#offlineUsersCollapse"
                  aria-expanded="false"
                  aria-controls="offlineUsersCollapse"
                  {% if offline_users == 0 %}disabled{% endif %}>
              Show Users
          </button>

          <div class="collapse mt-3 w-100" id="offlineUsersCollapse">
            <ul class="list-group list-group-flush text-start shadow-sm rounded">
              {% for user in all_users %}
                {% if not user.is_active %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  {{ user.username }}
                  <span class="badge bg-danger rounded-pill">Offline</span>
                </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<style>
  .card-hover {
    transition: all 0.3s ease;
    border-radius: 1rem;
    background: #fff;
  }

  .card-hover:hover {
    transform: translateY(-8px);
    box-shadow: 0 0.7rem 1.5rem rgba(0, 0, 0, 0.15);
  }

  .circle-icon {
    width: 90px;
    height: 90px;
    transition: all 0.4s ease;
    border: 4px solid rgba(255, 255, 255, 0.6);
  }

  .card-hover:hover .circle-icon {
    transform: scale(1.1);
    box-shadow: 0 0.6rem 1rem rgba(0, 0, 0, 0.25);
  }

  h2, h6 {
    transition: color 0.3s ease;
  }

  .card-hover:hover h2 {
    color: #0d6efd;
  }

  /* Collapse List */
  .list-group-item {
    font-size: 0.95rem;
    padding: 0.6rem 1rem;
    border: 0;
    border-bottom: 1px solid #f1f3fa;
  }

  .list-group-item:last-child {
    border-bottom: 0;
  }
</style>
{% endblock content %}
